<!DOCTYPE html>
<html>
<!--
====================================================
       _         _ _ _       _            ___ 
      | |       | (_) |     | |          / __)
  ____| | _   _ | |_| | ____| | _   ____| |__ 
 / _  | || \ / || | | |/ _  | || \ / ___)  __)
( ( | | |_) | (_| | | ( ( | | | | | |   | |   
 \_||_|____/ \____|_|_|\_||_|_| |_|_|   |_|  
 
====================================================
@ABDILAHRF
====================================================
-->
<head>
<meta charset="utf-8">
<title>WRITEUP IDSECCONF CTF 2016 : BIT - 100 &vert; @ABDILAHRF</title>
<meta name="description" content="Writeup Idsecconf CTF 2016 Online">
<meta name="keywords" content="idsecconf">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/images/idsecconf.jpg">

<meta name="twitter:title" content="Writeup Idsecconf CTF 2016 : Bit - 100">
<meta name="twitter:description" content="Writeup Idsecconf CTF 2016 Online">
<meta name="twitter:creator" content="@abdilahrf">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Writeup Idsecconf CTF 2016 : Bit - 100">
<meta property="og:description" content="Writeup Idsecconf CTF 2016 Online">
<meta property="og:url" content="http://localhost:4000/reverse/writeup-idescconf-2016-bit">
<meta property="og:site_name" content="@abdilahrf">
<meta property="og:image" content="http://localhost:4000/images//images/idsecconf.jpg">





<link rel="canonical" href="http://localhost:4000/reverse/writeup-idescconf-2016-bit">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="@abdilahrf Feed">
<link rel="author" href="https://plus.google.com/?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />


    <link href='http://fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,600,300,800,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="http://localhost:4000/assets/css/vendor/font-awesome.min.css">
    <link rel="stylesheet" href="http://localhost:4000/assets/css/vendor/normalize.css">
    <link rel="stylesheet" href="http://localhost:4000/assets/css/vendor/nprogress.css">
    <link rel="stylesheet" href="http://localhost:4000/assets/css/vendor/foundation.min.css">
    <link rel="stylesheet" href="http://localhost:4000/assets/css/style.css">
    <link rel="stylesheet" href="http://localhost:4000/assets/css/post.css">
    <link rel="stylesheet" href="http://localhost:4000/assets/css/code/monokai.css">





<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">

<style type="text/css">@media only screen and (min-width:43.75em){.notepad-post-content div>p:first-child:first-letter{float:left;font-size:4.688rem;line-height:4.375rem;padding-top:.25rem;padding-right:.5rem;padding-left:.188rem;font-family:serif}}</style>
</head>
<body class="post-template" itemscope itemtype="http://schema.org/WebPage">  

        <main id="notepad-post-container" class="notepad-post-container intro-effect-sliced" role="main">
            <header class="notepad-post-header">
                <div class="bg-img"></div>
                
                <div class="notepad-post-menu-header">

                    <a class="notepad-blog-logo" href="http://localhost:4000">
                        <img src="http://localhost:4000/images/logo.png" alt="Blog Logo" />
                    </a>

                <div class="notepad-blog-menu">      
    <div class="notepad-mobile-menu show-for-small">
        <a href="#"><i class="fa fa-bars"></i></a>
    </div>
    <ul class="notepad-menu">
        <li class="notepad-mobile-close-btn show-for-small text-right">
            <a href="#"><i class="fa fa-times"></i></a>
        </li>

            <li>
                    <a href="http://localhost:4000/">Home</a>
                 </li>

            <li>
                    <a href="http://localhost:4000/featured">Featured Posts</a>
                 </li>

            <li>
                    <a href="http://localhost:4000/categories">Categories</a>
                 </li>

            <li>
                    <a href="http://localhost:4000/about">About</a>
                 </li>
            
           <li><a href="http://localhost:4000/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
    </ul>

</div>
            </div>

            <div class="notepad-post-title bg-check">
                <h1>Writeup Idsecconf CTF 2016 : Bit - 100</h1>
                <p>by <strong>Abdillah Muhamad</strong> &#8212; on <a href="http://localhost:4000/tags/index.html#idsecconf" data-toggle="tooltip" title="Posts tagged with idsecconf" rel="tag">idsecconf</a> <strong><!-- <time datetime="2016-08-29 00:00:00 +0700">2016-08-29 00:00:00 +0700</time> --></strong></p>
            </div>
            <div class="bg-img"></div>
        </header>
        <button class="trigger bg-check" data-info="Read more"><span>Trigger</span></button>
        <img src="/images/idsecconf.jpg" alt="cover-image" />

        <article class="notepad-post-content post">
            <div><h3 id="problem-">Problem :</h3>

<p><code>nc 128.199.232.109 17846</code></p>

<h3 id="solusi-">Solusi :</h3>

<p>Diketahui bit adalah ELF x64 yang stripped</p>

<p><code>bit: ELF 64-bit LSB  executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=18a69419634b377f3ffbb736952951340bcd045b, stripped</code></p>

<p>Hasil objdump menunjukan file bit menggunakan beberapa lib</p>

<p>abdilahrf:~/workspace/CTF/idsecconf/reverse/bit $ objdump -T bit</p>

<p>bit:     file format elf64-x86-64</p>

<pre><code class="language-objdump">
DYNAMIC SYMBOL TABLE:
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 putchar
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 puts
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.4   __stack_chk_fail
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 printf
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 read
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 __libc_start_main
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 srand
0000000000000000  w   D  *UND*  0000000000000000              __gmon_start__
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 time
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 fflush
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 open
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.7   __isoc99_scanf
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 sleep
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 rand
00000000006020a0 g    DO .bss   0000000000000008  GLIBC_2.2.5 stdout
</code></pre>

<p>Terlihat rand,time,srand karena ini random number guessing yang saya pikirkan adalah
vulnerability PRNG seed tapi ternyata bukan lagi pula di situ jika kita menebak dengan benar
maka akan di hadiahkan jumlah taruhan + 100 programnya juga tidak melakukan looping maka
akan mustahil untuk menebak dengan benar sampai BTC nya = 100000</p>

<pre><code class="language-cpp">__int64 __fastcall sub_4009BB(__int64 a1, __int64 a2)
{
  unsigned int v2; // eax@1
  signed __int64 v3; // rbx@1
  __int64 result; // rax@5
  signed int v5; // [sp+14h] [bp-2Ch]@7
  __int64 v6; // [sp+18h] [bp-28h]@3
  __int64 v7; // [sp+20h] [bp-20h]@3
  __int64 v8; // [sp+28h] [bp-18h]@1

  v2 = time(0LL);
  srand(v2);
  v3 = (signed __int64)rand() &lt;&lt; 32;
  v8 = v3 | rand();
  if ( v8 &gt; 13 )
    v8 += 14LL;
  puts("++++ BITCOIN KASINO ++++!");
  fflush(0LL);
  sleep(3u);
  puts("Eddy Tongsis Masuk Dengan BTC90000...\nGayus Timbunan Masuk Dengan BTC100000...\nDan Kamu Dengan Saldo 100BTC.");
  fflush(0LL);
  sleep(3u);
  puts("Tebak Angka Yang Akan Naik - (Diatas 13)");
  fflush(0LL);
  sleep(3u);
  printf("Masukkan Angka Keberuntunganmu: ", a2);
  fflush(0LL);
  __isoc99_scanf(4197721LL, &amp;v6);
  printf("Nilai Taruhanmu (BTC): ");
  fflush(0LL);
  __isoc99_scanf(4197750LL, &amp;v7);
  if ( (signed int)v7 &lt;= 100 &amp;&amp; v7 &gt;= 0 )
  {
    sub_4008CD(8LL);
    puts("Hasilnya adalah...");
    fflush(0LL);
    sleep(3u);
    if ( v6 == v8 )
    {
      puts("Ajaib! Selamat Atas Tebakannya.");
      v5 = v7 + 100;
    }
    else
    {
      v5 = 100 - v7;
      printf("Bukan %lld. Yang Benar Adalah %lld.\n", v6, v8);
    }
    fflush(0LL);
    sleep(3u);
    if ( v5 &gt; 100000 )
    {
      sub_4008CD(5LL);
      printf("Anda Memenangkan %dBTC\nSelain Itu Akan Kami Berikan Bonus Berupa\n", (unsigned int)v5);
      sleep(5u);
      sub_40091C(5LL);
    }
    else
    {
      printf("Kamu Kalah! (%dBTC) \n", (unsigned int)v5);
    }
    result = 0LL;
  }
  else
  {
    puts("Taruhan ditolak, saldo kamu hanya 100BTC");
    result = 0LL;
  }
  return result;
}
</code></pre>

<p>Idenya adalah kita tidak harus menebak angka yang random tapi kita bisa mengoverflow 
saldo BTC kita dengan membuat angka tebakan kita overflow dan kita bisa menginput sembarang
di jumlah taruhan.</p>

<p>variable yang menyimpan saldo BTC dan angka keberuntungan diketahui int 64.
setelah membaca tentang Int64 di <a href="https://rosettacode.org/wiki/Integer_overflow">Integer Overflow</a></p>

<p>maka kita dapat melakukan integer overflow sehingga BTC kita &gt; 10000</p>

<pre><code class="language-bash">echo -n -e "18446744073709551616\n3133731337\n"| ./bit 
</code></pre>

<p><img src="/images/bit_flaglokal.png" alt="Bit Flag Lokal" /></p>

<p>dan di dapatkan flag : <code>flag{Integer_H4ri_Ini}</code></p>

<p><img src="/images/bit_flagremote.png" alt="Bit Flag Remote" /></p>

</div>
        </article>
        <div class="cf"></div>
        <div class="row text-center">
            <section class="notepad-post-share">
                <a class="twitter-icon" href="https://twitter.com/intent/tweet?text=&quot;Writeup Idsecconf CTF 2016 : Bit - 100&quot;%20http://localhost:4000/reverse/writeup-idescconf-2016-bit%20via%20&#64;abdilahrf"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
                    <i class="fa fa-twitter"></i>
                </a>
                <a class="facebook-icon" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/reverse/writeup-idescconf-2016-bit"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
                    <i class="fa fa-facebook"></i>
                </a>
                <a class="google-icon" href="https://plus.google.com/share?url=http://localhost:4000/reverse/writeup-idescconf-2016-bit"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title="Share on Google+">
                    <i class="fa fa-google-plus"></i>
                </a>
            </section>
        </div>
        <div class="cf"></div>
        
            <div class="notepad-author-info">
                <div class="row">
                    <section class="notepad-post-author small-12 columns">
                        
                            <img src="https://avatars2.githubusercontent.com/u/6015012?v=3&s=460" class="notepad-post-author-avatar" alt="Abdillah Muhamad's photo">
                        
                        
                            <span class="author-label">Author</span>
                            <h1>Abdillah Muhamad</h1>
                        
                        
                            <p><a href="mailto:hasny1337@gmail.com" class="author-website">hasny1337@gmail.com</a></p>
                        
                        
                            <p>Coffe make you like a hero</p>
                        
                    </section>
                </div>
            </div>
 
        
        <div class="cf"></div>
        
        <section class="notepad-disqus row">
    <div class="small-12 columns">
        <h1 class="notepad-comments-header">Comments</h1>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'abdilahrf'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
</section>

        <div class="cf"></div>

    <footer class="notepad-site-footer">
    <div class="copyright">
         <section>All content copyright <a href="http://localhost:4000/about">Abdillah Muhamad</a> &copy; 2017 &bull; All rights reserved.</section>
         <section>Proudly published with <a class="icon-ghost" href="https://jekyllrb.com/">Jekyll</a></section>
    </div>
    <div class="social-icons">
        
        
        <a href="http://twitter.com/abdilahrf">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-twitter fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="https://plus.google.com/">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-google-plus fa-stack-1x"></i>
            </span>
        </a>
        
        
        
        <a href="http://github.com/abdilahrf">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-github fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="http://facebook.com/abdilah.jk">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-facebook fa-stack-1x"></i>
            </span>
        </a>
        
    </div>
    
    <div class="cf"></div>
</footer> 
</main>    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.11.1.min.js"><\/script>')</script>
    <script src="http://localhost:4000/assets/js/vendor/modernizr.js"></script>
    <script src="http://localhost:4000/assets/js/foundation.min.js"></script>
    <script src="http://localhost:4000/assets/js/vendor/background-check.js"></script>
    <script src="http://localhost:4000/assets/js/vendor/post-header-animations.js"></script>
    <script src="http://localhost:4000/assets/js/notepad.js"></script>
    <script src="http://localhost:4000/assets/js/scripts.min.js"></script>
    <script src="http://localhost:4000/assets/js/vendor/nprogress.js"></script>

    <script>
      $(document).foundation();
    </script>
    <script type='text/javascript'>console.log("@abdilahrf");</script>
    <script type='text/javascript'>console.log("https://abdilahrf.me");</script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-96190645-1', 'auto');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

</script>

<script>NProgress.start();var interval=setInterval(function(){NProgress.inc()},1000);jQuery(window).load(function(){clearInterval(interval);NProgress.done()});jQuery(window).unload(function(){NProgress.start()});</script>
 
</body>
</html>